---
import Layout from '../../layouts/Layout.astro';
import RecipeHeader from '../../components/RecipeHeader.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const recipes = await getCollection('recipes');
  return recipes.map((recipe) => ({
    params: { slug: recipe.slug },
    props: { recipe },
  }));
}

const { recipe } = Astro.props;
const { Content } = await recipe.render();
---

<Layout title={`${recipe.data.title} | Mise`}>
  <!-- Recipe Header with breadcrumb, metadata, and tags -->
  <RecipeHeader {recipe} />

  <!-- Recipe Content -->
  <article class="mt-8 bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">

    <div class="p-6 sm:p-10 grid md:grid-cols-[1fr_1.5fr] gap-12">
      <!-- Ingredients Column -->
      <div>
        <h3 class="text-lg font-bold text-slate-900 mb-4 flex items-center gap-2 border-b border-slate-100 pb-2">
          <svg class="w-5 h-5 text-indigo-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"></path>
          </svg>
          Ingredients
        </h3>
        {
          recipe.data.ingredients && recipe.data.ingredients.length > 0 ? (
            <ul class="space-y-3">
              {recipe.data.ingredients.map((ingredient) => (
                <li class="flex items-start group">
                  <input
                    type="checkbox"
                    class="mt-1 mr-3 h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer shrink-0"
                  />
                  <span class="text-slate-700 leading-relaxed group-hover:text-slate-900 transition-colors">
                    {ingredient}
                  </span>
                </li>
              ))}
            </ul>
          ) : (
            <p class="text-slate-400 italic text-sm">No ingredients listed.</p>
          )
        }
      </div>

      <!-- Content Column (Description, Directions, Notes, Nutrition) -->
      <div class="recipe-content prose prose-slate max-w-none
        prose-headings:font-bold prose-headings:text-slate-900 
        prose-h2:text-lg prose-h2:mb-4 prose-h2:flex prose-h2:items-center prose-h2:gap-2
        prose-h2:border-b prose-h2:border-slate-100 prose-h2:pb-2 prose-h2:mt-8 first:prose-h2:mt-0
        prose-h3:text-lg prose-h3:mb-3
        prose-p:text-slate-700 prose-p:leading-relaxed prose-p:mb-4
        prose-strong:text-slate-900 prose-strong:font-semibold
        prose-ol:space-y-4 prose-ol:my-6
        prose-li:text-slate-700 prose-li:leading-relaxed
        prose-ul:space-y-2 prose-ul:my-4
        prose-a:text-indigo-600 prose-a:no-underline hover:prose-a:text-indigo-500 hover:prose-a:underline
        marker:text-slate-400 marker:font-semibold
      ">
        <Content />
      </div>
    </div>
  </article>
</Layout>
