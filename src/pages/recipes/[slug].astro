---
import Layout from '../../layouts/Layout.astro';
import RecipeHeader from '../../components/RecipeHeader.astro';
import { getCollection } from 'astro:content';

export async function getStaticPaths() {
  const recipes = await getCollection('recipes');
  return recipes.map((recipe) => ({
    params: { slug: recipe.slug },
    props: { recipe },
  }));
}

const { recipe } = Astro.props;
const { Content } = await recipe.render();
---

<Layout title={`${recipe.data.title} | Mise`}>
  <!-- Recipe Header with breadcrumb, metadata, and tags -->
  <RecipeHeader {recipe} />

  <!-- Recipe Content -->
  <article class="mt-8 bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">

    <div class="p-6 sm:p-10 grid md:grid-cols-[1fr_1.5fr] gap-12">
      <!-- Ingredients Column -->
      <div>
        <h3 class="text-lg font-bold text-slate-900 mb-4 flex items-center border-b border-slate-100 pb-2">
          Ingredients
        </h3>
        {
          recipe.data.ingredients && recipe.data.ingredients.length > 0 ? (
            <ul class="space-y-3">
              {recipe.data.ingredients.map((ingredient) => (
                <li class="flex items-start group">
                  <input
                    type="checkbox"
                    class="mt-1 mr-3 h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 cursor-pointer shrink-0"
                  />
                  <span class="text-slate-700 leading-relaxed group-hover:text-slate-900 transition-colors">
                    {ingredient}
                  </span>
                </li>
              ))}
            </ul>
          ) : (
            <p class="text-slate-400 italic text-sm">No ingredients listed.</p>
          )
        }
      </div>

      <!-- Content Column (Description, Directions, Notes, Nutrition) -->
      <div class="prose prose-slate prose-headings:font-bold prose-headings:text-slate-900 prose-p:text-slate-700 prose-li:text-slate-700 marker:text-slate-400 prose-a:text-indigo-600 hover:prose-a:text-indigo-500 max-w-none">
        <Content />
      </div>
    </div>
  </article>
</Layout>
